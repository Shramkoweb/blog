---
title: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
date: "2021-01-09"
description: React.memo & useCallback. –ö–∞–∫ –Ω–µ –¥–µ–ª–∞—Ç—å –ª–∏—à–Ω–∏—Ö –æ—Ç—Ä–∏—Å–æ–≤–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ü—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏ üëæ
---

–ß–∞—Å—Ç–æ –Ω–∞ —Å–∞–π—Ç–µ –µ—Å—Ç—å –±–ª–æ–∫ —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–∞—à–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏.

![Follow us links list](./follow.png)

–ò –º—ã —Ö–æ—Ç–∏–º —Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ —Å—É–º–º–µ –Ω–∞–∂–∞–ª–∏ –Ω–∞ –Ω–∞—à–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏. –ù–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç
**GTM** (Google Tag Manager).

#### –ü—Ä–∏–º–µ—Ä

```jsx
const links = [
  {
    id: "0",
    href: "#",
    label: "Facebook"
  },
  {
    id: "1",
    href: "#",
    label: "Linkedin"
  },
  {
    id: "2",
    href: "#",
    label: "Slack"
  },
  {
    id: "3",
    href: "#",
    label: "Twitter"
  }
];

const LinkItem = ({ href, label, onClick }) => {
  return (
    <a onClick={onClick} href={href}>
      {label}
    </a>
  );
};

export default function App() {
  const [count, setCount] = React.useState(0);

  const handleLinkClick = () => {
    setCount((prevState) => prevState + 1);
  };

  return (
    <div>
      <ul>
        {links.map((link) => (
          <LinkItem
            key={link.id}
            href={link.href}
            label={link.label}
            onClick={handleLinkClick}
          />
        ))}
      </ul>

      <span>{count}</span>
    </div>
  );
}
```

–ù–∞ –≤—ã—Ö–æ–¥–µ –Ω–µ–±–æ–ª—å—à–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫–∏ –∏ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª-–≤–æ –Ω–∞–∂–∞—Ç–∏–π.
–í—Ä–æ–¥–µ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞–¥–æ, –Ω–æ –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–∂–∞—Ç—å –Ω–∞ —Å—Å—ã–ª–∫—É...

![Profiler screenshot](./profiler-info.png)

##### –ü—Ä–æ–±–ª–µ–º–∞

–ü–æ–º–∏–º–æ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ —Å—á–µ—Ç—á–∏–∫–∞ –Ω–∞–∂–∞—Ç–∏–π, –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –∏ —Å–ø–∏—Å–æ–∫ —Å—Å—ã–ª–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è.

![Profiler screenshot](./profiler-warn.png)

–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —É–±—Ä–∞—Ç—å –ª–∏—à–Ω–∏–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–ø–∏—Å–∫–∞.

–ì—É–≥–ª–∏–º... üßê.

–°—Ä–∞–∑—É –≤–∏–¥–∏–º –≤—ã—Ö–æ–¥, –æ–±–µ—Ä–Ω—É—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ <a href='https://ru.reactjs.org/docs/react-api.html#reactmemo' target="_blank" rel="noreferrer">**React.memo**</a>

> –ï—Å–ª–∏ –≤–∞—à –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç –æ–¥–Ω–æ –∏, —Ç–æ –∂–µ –ø—Ä–∏ –Ω–µ–º–µ–Ω—è—é—â–∏—Ö—Å—è –ø—Ä–æ–ø—Å–∞—Ö, –≤—ã –º–æ–∂–µ—Ç–µ –æ–±–µ—Ä–Ω—É—Ç—å –µ–≥–æ –≤ –≤—ã–∑–æ–≤ React.memo –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö, –º–µ–º–æ–∏–∑–∏—Ä—É—è —Ç–µ–º —Å–∞–º—ã–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ React –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∞, –∏–∑–±–µ–≥–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞.

```jsx
const LinkItem = React.memo(({ href, label, onClick }) => {
  return (
    <a onClick={onClick} href={href}>
      {label}
    </a>
  );
});
```

–ö–∞–∫ –≤–∏–¥–∏–º, –Ω–∞–º —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑ –∑–∞–Ω–æ–≤–æ.

![Profiler screenshot](./profile-memo.png)

–í —á–µ–º –ø—Ä–æ–±–ª–µ–º–∞? –°–º–æ—Ç—Ä–∏–º –ø—Ä–∏—á–∏–Ω—É –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏.

![why rerender](why.png)

–ß—Ç–æ **onClick**? –≠—Ç–æ –∂–µ –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç **LinkItem** –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª-–≤–æ –Ω–∞–∂–∞—Ç–∏–π.
–ù–æ –º—ã –∂–µ –µ–µ –Ω–µ –º–µ–Ω—è–µ–º –Ω–∏–∫–∞–∫, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

##### –ö–∞–∫ React –ø–æ–Ω–∏–º–∞–µ—Ç, —á—Ç–æ —Å—Ç–æ–∏—Ç –æ–±–Ω–æ–≤–∏—Ç—å?

React –¥–µ–ª–∞–µ—Ç —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π **Shallow compare** - –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.

> shallowCompare –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã —Ç–µ–∫—É—â–∏—Ö props –∏ state —Å –±—É–¥—É—â–∏–º–∏ nextProps –∏ nextState. –ü—Ä–∏ –ø–µ—Ä–µ–±–æ—Ä–µ –∫–ª—é—á–µ–π —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è true, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∫–ª—é—á–∞ –≤ –∫–∞–∂–¥–æ–º –æ–±—ä–µ–∫—Ç–µ –∏–º–µ—é—Ç –Ω–µ—Å—Ç—Ä–æ–≥–æ–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ.

–ù–∞—à –ø—Ä–æ–±–ª–µ–º–Ω—ã–π **LinkItem** –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç **props**, –¥–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ –æ–Ω–∏ –≤—ã–≥–ª—è–¥—è—Ç –∏ –∫–∞–∫ –∏—Ö —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç React, 
—á—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —Å—Ç–æ–∏—Ç –ª–∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

**props** - —ç—Ç–æ –æ–±—ä–µ–∫—Ç.

```js
{
  href: "#"; // —Å—Ç—Ä–æ–∫–∞
  label: "Facebook"; // —Å—Ç—Ä–æ–∫–∞
  onClick: () => {}; // –§—É–Ω–∫—Ü–∏—è handleLinkClick –∫–æ—Ç–æ—Ä—É—é –º—ã –ø–µ—Ä–µ–¥–∞–µ–º —Å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
}
```

–î–ª—è –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç–∏–ø–∞ **string, number, boolean, undefined** –∏ —Ç.–¥ React –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º.

–î–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö **object, function** - –æ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–º–µ–Ω—è–ª–∞—Å—å –ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–∏—Ö.

> "function" - —ç—Ç–æ –ø–æ —Å—É—Ç–∏ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –≤ JS, –∞ –ø—Ä–æ—Å—Ç–æ –æ–±—ä–µ–∫—Ç. –ù–æ typeof –≤–µ—Ä–Ω–µ—Ç "function" üòÉ

–ù–∞—à–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∫–∞–∫ —Ä–∞–∑ –∫—Ä–æ–µ—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º. –î–∞–≤–∞–π—Ç–µ –ø–æ —à–∞–≥–∞–º –æ–±—ä—è—Å–Ω—é —á—Ç–æ –¥–µ–ª–∞–µ—Ç React –∫–æ–≥–¥–∞ –º—ã –∫–ª–∏–∫–∞–µ–º –Ω–∞ —Å—Å—ã–ª–∫—É
–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–∞—à —Å—á–µ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏–π:

1. –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç props **onClick** –≤ **LinkItem**, –∫–æ—Ç–æ—Ä—ã–π –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —è–≤–ª—è–µ—Ç—Å—è —Å—Å—ã–ª–∫–æ–π –Ω–∞ **handleLinkClick** –≤ **App**. 
   handleLinkClick —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—Ç–µ–π—Ç **count** –∏ App –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –µ–º—É –Ω—É–∂–Ω–æ –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ count.
   
2. –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞—é—Ç—Å—è –≤—Å–µ **LinkItem** –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π **onClick** –ø—Ä–æ–ø—Å–∞, —Ö–æ—Ç—è –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º React.memo. 

3. –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ **count** (—Å—á–µ—Ç—á–∏–∫) —Ç–∞–∫ –∫–∞–∫ –ø–æ–º–µ–Ω—è–ª—Å—è —Å—Ç–µ–π—Ç **App**.

–ü—Ä–æ–±–ª–µ–º–∞ –≤ –ø—É–Ω–∫—Ç–µ 2. –ü—Ä–æ–ø—Å—ã **href** –∏ **label** —ç—Ç–æ –ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏, –∏ React.memo –≤–∏–¥–∏—Ç, —á—Ç–æ –æ–Ω–∏ –Ω–µ 
–ø–æ–º–µ–Ω—è–ª–∏—Å—å. –û–¥–Ω–∞–∫–æ –æ–Ω —Å–ø–æ—Ç—ã–∫–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ **onClick**.

–î–µ–ª–æ –≤ —Ç–æ–º, —á—Ç–æ –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—É–Ω–∫—Ç 3. React –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç —Ç–µ–ª–æ —Ñ-–∏ **App**. –ò —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
—Å—Ç–µ–π—Ç–∞ —É –Ω–∞—Å **—Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è** —Ñ-—è **handleLinkClick**. –û–Ω–∞ –∂–µ –ø–æ **—Å—Å—ã–ª–∫–µ** —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ React.memo(LinkItem) 
–∏ —Ç–æ—Ç –≤–∏–¥–∏—Ç, **—á—Ç–æ —ç—Ç–æ –Ω–æ–≤–∞—è —Å—Å—ã–ª–∫–∞, –Ω–∞ –Ω–æ–≤—É—é —Ñ-—é** –∏ –¥–µ–ª–∞–µ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞.

![Problem diagram](problem.png)

#### –§–∏–∫—Å–∏–º

–ù–∞–º –Ω—É–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å —Ä–µ–∞–∫—Ç—É, —á—Ç–æ —Ñ-—é **handleLinkClick** –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑. –ò –ø—Ä–∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞—Ö **App** –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –µ–µ –∑–∞–Ω–æ–≤–æ.

–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º <a href='https://ru.reactjs.org/docs/hooks-reference.html#usecallback' target="_blank" rel="noreferrer">**React.useCallback**</a>

```js
 const handleLinkClick = React.useCallback(() => {
    setCount((prevState) => prevState + 1);
  }, []); // –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—Ç–æ—Ä—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º, —Ç–∞–∫ –∫–∞–∫ –º—ã —Ö–æ—Ç–∏–º —Å–æ–∑–¥–∞—Ç—å —Ñ-—é 1 —Ä–∞–∑ –∏ –Ω–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å –µ–µ –±–æ–ª—å—à–µ
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –Ω–∞–¥–æ –∏ –Ω–µ –¥–µ–ª–∞–µ—Ç –ª–∏—à–Ω–∏–µ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏. üèÜ

![Result screenshot](result.png)

##### –ü–æ–ª–µ–∑–Ω–æ—Å—Ç–∏
- [–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–æ–¥ –≤ –ø–µ—Å–æ—á–Ω–∏—Ü–µ](https://codesandbox.io/s/reactmemo-usecallback-48eeu)
- [How to use React memo](https://www.robinwieruch.de/react-memo)
- [React Performance Optimization Tips](https://dev.to/harshdand/react-performance-optimization-tips-4238)
